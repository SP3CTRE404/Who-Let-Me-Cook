<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:viewmodels="clr-namespace:WhoLetMeCook.ViewModels"
             x:Class="WhoLetMeCook.Views.RecipeDetailPage"
             x:DataType="viewmodels:RecipeDetailViewModel"
             Title="{Binding Recipe.strMeal}"
             BackgroundColor="Brown">
    <Grid>
        <ScrollView>
            <VerticalStackLayout Spacing="15" Padding="20">
                <Image Aspect="AspectFill"
                       HeightRequest="250"
                       Source="{Binding Recipe.strMealThumb}" />
                <Label Text="{Binding Recipe.strMeal}"
                       FontSize="Header"
                       FontAttributes="Bold"
                       TextColor="NavajoWhite"/>
                <Label Text="{Binding Recipe.strCategory, StringFormat='Category: {0}'}"
                       FontSize="Subtitle"
                       TextColor="Wheat"/>

                <!-- Serving Size Adjuster -->
                <HorizontalStackLayout Spacing="10" HorizontalOptions="Center" VerticalOptions="Center" Margin="0,10,0,0">
                    <Label Text="Servings:" TextColor="Goldenrod" VerticalOptions="Center" FontAttributes="Bold"/>
                    <Stepper Value="{Binding ServingSize}" Minimum="1" Maximum="20" Increment="1" />
                    <Label Text="{Binding ServingSize}" TextColor="NavajoWhite" VerticalOptions="Center" FontSize="Medium" FontAttributes="Bold"/>
                </HorizontalStackLayout>

                <!-- Ingredients Section -->
                <Label Text="Ingredients"
                       FontSize="Title"
                       FontAttributes="Bold"
                       TextColor="Goldenrod"
                       Margin="0,15,0,5"/>
                <BoxView HeightRequest="1" Color="Goldenrod" />
                <CollectionView ItemsSource="{Binding SimplifiedIngredients}">
                    <CollectionView.ItemTemplate>
                        <DataTemplate>
                            <Label Text="{Binding .}" TextColor="Wheat" Padding="5,2"/>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>

                <!-- Instructions Section -->
                <Label Text="Instructions"
                       FontSize="Title"
                       FontAttributes="Bold"
                       TextColor="Goldenrod"
                       Margin="0,20,0,5"/>
                <BoxView HeightRequest="1" Color="Goldenrod" />
                <CollectionView ItemsSource="{Binding SimplifiedInstructions}">
                    <CollectionView.ItemTemplate>
                        <DataTemplate>
                            <Grid Padding="5,5" ColumnDefinitions="Auto, *">
                                <Label Grid.Column="0" Text="â€¢" VerticalOptions="Start" TextColor="Goldenrod" Margin="0,0,5,0"/>
                                <Label Grid.Column="1" Text="{Binding .}" TextColor="Wheat"/>
                            </Grid>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>

            </VerticalStackLayout>
        </ScrollView>
        <ActivityIndicator IsRunning="{Binding IsBusy}" IsVisible="{Binding IsBusy}" Color="Orange" HorizontalOptions="Center" VerticalOptions="Center"/>
    </Grid>
</ContentPage>
